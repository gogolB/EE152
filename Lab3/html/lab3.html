
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Lab 3</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-02-15"><meta name="DC.source" content="lab3.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Lab 3</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Spatial Frequencies 1</a></li><li><a href="#11">Spatial Frequencies 2</a></li><li><a href="#15">More Fun with Frequencies</a></li><li><a href="#16">Geometric Transforms</a></li></ul></div><pre class="codeinput">clear <span class="string">all</span>;
close <span class="string">all</span>;
clc;
</pre><h2>Spatial Frequencies 1<a name="2"></a></h2><p>Loading in and Resizing the images</p><pre class="codeinput">bricks = imread(<span class="string">'bricks.jpg'</span>);
sky = imread(<span class="string">'sky.jpg'</span>);

bricks_256 = imresize(bricks, [256 256]);
sky_256 = imresize(sky, [256 256]);
</pre><p>Displaying the Fourier Transform of the bricks and the sky</p><pre class="codeinput">figure;
imshow(bricks_256)
bricks_gray = rgb2gray(bricks_256);
title(<span class="string">'Sky Image'</span>)

figure;
imagesc(log(abs(fftshift(fft2(bricks_gray)))))
title(<span class="string">'FFT of bricks'</span>)

figure;
imshow(sky_256)
sky_gray = rgb2gray(sky_256);
title(<span class="string">'Sky image'</span>)

figure;
imagesc(log(abs(fftshift(fft2(sky_gray)))))
title(<span class="string">'FFT of sky'</span>)
</pre><img vspace="5" hspace="5" src="lab3_01.png" alt=""> <img vspace="5" hspace="5" src="lab3_02.png" alt=""> <img vspace="5" hspace="5" src="lab3_03.png" alt=""> <img vspace="5" hspace="5" src="lab3_04.png" alt=""> <p>Applying a low pass filter to the bricks yields the following</p><pre class="codeinput">lpf = fspecial(<span class="string">'gaussian'</span>,5,1.7);
hpf = [0 0 0 0 0;
       0 0 0 0 0;
       0 0 1 0 0;
       0 0 0 0 0;
       0 0 0 0 0] - lpf;
bricks_lpf = imfilter(bricks_gray, lpf, <span class="string">'replicate'</span>);
bricks_hpf = imfilter(bricks_gray, hpf, <span class="string">'replicate'</span>);

figure;
imshow(uint8(bricks_lpf))
title(<span class="string">'Bricks after LPF'</span>);
figure;
imagesc(log(abs(fftshift(fft2(bricks_lpf)))))
title(<span class="string">'Magnitude of the bricks after LPF'</span>);
figure;
imagesc(angle(fftshift(fft2(bricks_lpf))))
title(<span class="string">'Phase of the bricks after LPF'</span>);

figure;
imshow(uint8(bricks_hpf))
title(<span class="string">'Bricks after HPF'</span>);
figure;
imagesc(log(abs(fftshift(fft2(bricks_hpf)))))
title(<span class="string">'Magnitude of the bricks after HPF'</span>);
figure;
imagesc(angle(fftshift(fft2(bricks_hpf))))
title(<span class="string">'Phase of the bricks after HPF'</span>);
</pre><img vspace="5" hspace="5" src="lab3_05.png" alt=""> <img vspace="5" hspace="5" src="lab3_06.png" alt=""> <img vspace="5" hspace="5" src="lab3_07.png" alt=""> <img vspace="5" hspace="5" src="lab3_08.png" alt=""> <img vspace="5" hspace="5" src="lab3_09.png" alt=""> <img vspace="5" hspace="5" src="lab3_10.png" alt=""> <p>The energy for the high pass and low pass are given by:</p><pre class="codeinput">energy_lpf = norm(fft2(bricks_lpf),2);
energy_hpf = norm(fft2(bricks_hpf),2);
fprintf(<span class="string">'Bricks Energy HPF = %d, LPF Energy = %d\n'</span>, energy_hpf, energy_lpf);
</pre><pre class="codeoutput">Bricks Energy HPF = 2.691808e+05, LPF Energy = 1.083897e+07
</pre><p>Doing the same to the sky image yields the following:</p><pre class="codeinput">sky_lpf = imfilter(sky_gray, lpf, <span class="string">'replicate'</span>);
sky_hpf = imfilter(sky_gray, hpf, <span class="string">'replicate'</span>);

figure;
imshow(uint8(sky_lpf))
title(<span class="string">'Sky after LPF'</span>);
figure;
imagesc(log(abs(fftshift(fft2(sky_lpf)))))
title(<span class="string">'Magnitude of the sky after LPF'</span>);
figure;
imagesc(angle(fftshift(fft2(sky_lpf))))
title(<span class="string">'Phase of the sky after LPF'</span>);

figure;
imshow(uint8(sky_hpf))
title(<span class="string">'Sky after HPF'</span>);
figure;
imagesc(log(abs(fftshift(fft2(sky_hpf)))))
title(<span class="string">'Magnitude of the sky after HPF'</span>);
figure;
imagesc(angle(fftshift(fft2(sky_hpf))))
title(<span class="string">'Phase of the sky after HPF'</span>);
</pre><img vspace="5" hspace="5" src="lab3_11.png" alt=""> <img vspace="5" hspace="5" src="lab3_12.png" alt=""> <img vspace="5" hspace="5" src="lab3_13.png" alt=""> <img vspace="5" hspace="5" src="lab3_14.png" alt=""> <img vspace="5" hspace="5" src="lab3_15.png" alt=""> <img vspace="5" hspace="5" src="lab3_16.png" alt=""> <p>The energy for the high pass and low pass are given by:</p><pre class="codeinput">energy_lpf = norm(fft2(sky_lpf),2);
energy_hpf = norm(fft2(sky_hpf),2);
fprintf(<span class="string">'Sky Energy HPF = %d, LPF Energy = %d\n'</span>, energy_hpf, energy_lpf);
</pre><pre class="codeoutput">Sky Energy HPF = 1.646941e+04, LPF Energy = 8.817600e+06
</pre><p>Adding in some singals to the FFT yields the following:</p><pre class="codeinput">sky_fft = fftshift(fft2(sky_gray));

figure;
imagesc(log(abs(sky_fft)));
title(<span class="string">'FFT before adding signal'</span>);

amt_to_add = 10e5;

sky_fft(128+64,128+64) = amt_to_add;
sky_fft(128-64,128-64) = amt_to_add;
sky_fft(128-64,128+64) = amt_to_add;
sky_fft(128+64,128-64) = amt_to_add;

sky_fft(128,128+64) = amt_to_add;
sky_fft(128,128-64) = amt_to_add;
sky_fft(128+64,128) = amt_to_add;
sky_fft(128-64,128) = amt_to_add;

figure;
imagesc(log(abs(sky_fft)));
title(<span class="string">'FFT after adding signal'</span>);

sky_fft_modified = ifftshift(sky_fft);
sky_gray_modfied = uint8(ifft2(sky_fft_modified));

figure;
imshow(sky_gray_modfied);
title(<span class="string">'Image after adding signal'</span>);
</pre><pre class="codeoutput">Warning: Displaying real part of complex input. 
</pre><img vspace="5" hspace="5" src="lab3_17.png" alt=""> <img vspace="5" hspace="5" src="lab3_18.png" alt=""> <img vspace="5" hspace="5" src="lab3_19.png" alt=""> <p>Removing the signal</p><pre class="codeinput">sky_fft(128+64,128+64) = 0;
sky_fft(128-64,128-64) = 0;
sky_fft(128-64,128+64) = 0;
sky_fft(128+64,128-64) = 0;

sky_fft(128,128+64) = 0;
sky_fft(128,128-64) = 0;
sky_fft(128+64,128) = 0;
sky_fft(128-64,128) = 0;

figure;
imagesc(log(abs(sky_fft)));
title(<span class="string">'FFT after removing signal'</span>);

sky_fft_modified = ifftshift(sky_fft);
sky_gray_modfied = uint8(ifft2(sky_fft_modified));

figure;
imshow(sky_gray_modfied);
title(<span class="string">'Image after Removing signal'</span>);
</pre><img vspace="5" hspace="5" src="lab3_20.png" alt=""> <img vspace="5" hspace="5" src="lab3_21.png" alt=""> <h2>Spatial Frequencies 2<a name="11"></a></h2><p>Load in the images</p><pre class="codeinput">g_img = imread(<span class="string">'G.jpg'</span>);
b_img = imread(<span class="string">'B.jpg'</span>);

g_256 = imresize(g_img, [256 256]);
b_256 = imresize(b_img, [256 256]);

g_gray = rgb2gray(g_256);
g_gray = imrotate(g_gray, 90);
b_gray = rgb2gray(b_256);

g_fft = fft2(g_gray);
b_fft = fft2(b_gray);

figure;
imshow(g_gray);
title(<span class="string">'G Image'</span>);

figure;
imagesc(log(abs(fftshift(g_fft))));
title(<span class="string">'FFT of G Image'</span>);

figure;
imshow(b_gray);
title(<span class="string">'B Image'</span>);

figure;
imagesc(log(abs(fftshift(b_fft))));
title(<span class="string">'FFT of B Image'</span>);
</pre><img vspace="5" hspace="5" src="lab3_22.png" alt=""> <img vspace="5" hspace="5" src="lab3_23.png" alt=""> <img vspace="5" hspace="5" src="lab3_24.png" alt=""> <img vspace="5" hspace="5" src="lab3_25.png" alt=""> <p>Sharpening the image with unsharp</p><pre class="codeinput">g_unsharp = imsharpen(g_gray);
b_unsharp = imsharpen(b_gray);

figure;
imshow(g_unsharp);
title(<span class="string">'G with unsharp'</span>);

figure;
imshow(b_unsharp);
title(<span class="string">'B with unsharp'</span>);
</pre><img vspace="5" hspace="5" src="lab3_26.png" alt=""> <img vspace="5" hspace="5" src="lab3_27.png" alt=""> <p>Sharpening the images with high boost</p><pre class="codeinput">[J0, J1] = Highboost(g_gray, 1.5);

figure;
imshow(J0);
title(<span class="string">'G with highboost - J0'</span>);

figure;
imshow(J1);
title(<span class="string">'G with highboost - J1'</span>);

[J0, J1] = Highboost(b_gray, 1.5);

figure;
imshow(J0);
title(<span class="string">'B with highboost - J0'</span>);

figure;
imshow(J1);
title(<span class="string">'B with highboost - J1'</span>);
</pre><img vspace="5" hspace="5" src="lab3_28.png" alt=""> <img vspace="5" hspace="5" src="lab3_29.png" alt=""> <img vspace="5" hspace="5" src="lab3_30.png" alt=""> <img vspace="5" hspace="5" src="lab3_31.png" alt=""> <p>Swapping the phase of the two images.</p><pre class="codeinput">g_mag = abs(g_fft);
b_mag = abs(b_fft);
g_phase = angle(g_fft);
b_phase = angle(b_fft);

swapped1 = g_mag .* exp(1i*b_phase);
swapped2 = b_mag .* exp(1i*g_phase);

s1_img = uint8(ifft2(swapped1));
s2_img = uint8(ifft2(swapped2));

figure;
imshow(s1_img);
title(<span class="string">'G Magnitude with B phase'</span>);

figure;
imshow(s2_img);
title(<span class="string">'B Magnitude with G phase'</span>);
</pre><img vspace="5" hspace="5" src="lab3_32.png" alt=""> <img vspace="5" hspace="5" src="lab3_33.png" alt=""> <h2>More Fun with Frequencies<a name="15"></a></h2><pre class="codeinput">gogol = imread(<span class="string">'fg2.jpg'</span>);
<span class="comment">%gogol = imcrop(gogol, [194 290 333 538]);</span>
gogol = imcrop(gogol, [194 290 139 248]);
gogol = imresize(gogol, [256 256]);

jesse = imread(<span class="string">'Jesse.jpg'</span>);
<span class="comment">%jesse = imcrop(jesse, [163 177 260 351]);</span>
jesse = imcrop(jesse, [163 177 97 174]);
jesse = imresize(jesse, [256 256]);

fixedPt = [82 118; 172 120];
movingPt = [90 128; 176 139];

tform = fitgeotrans(movingPt,fixedPt,<span class="string">'NonreflectiveSimilarity'</span>);

Jregistered = imwarp(jesse,tform,<span class="string">'OutputView'</span>,imref2d(size(gogol)));

figure;
imshowpair(gogol,Jregistered)
title(<span class="string">'Images of Jesse and Me after being reg'</span>);

lpf = fspecial(<span class="string">'gaussian'</span>,5,10);
hpf = [0 0 0 0 0;
       0 0 0 0 0;
       0 0 1 0 0;
       0 0 0 0 0;
       0 0 0 0 0] - lpf;

gogol_lpf = imfilter(double(gogol), lpf, <span class="string">'replicate'</span>);
Jregistered_hpf = imfilter(double(Jregistered), hpf, <span class="string">'replicate'</span>);

figure;
imshow(uint8(gogol_lpf + 15*Jregistered_hpf));
title(<span class="string">'High freq of Jesse and Low freq of Gogol'</span>);
</pre><img vspace="5" hspace="5" src="lab3_34.png" alt=""> <img vspace="5" hspace="5" src="lab3_35.png" alt=""> <h2>Geometric Transforms<a name="16"></a></h2><p>Rotation a mesh</p><pre class="codeinput">theta=-30;
theta=deg2rad(theta);
R = [cos(theta) -sin(theta);
    sin(theta) cos(theta)];


[x,y] = meshgrid(1:64);
C = 0.*(x + y);

rot_x = zeros(64,64);
rot_y = zeros(64,64);
<span class="keyword">for</span> i = 1:1:length(x)
    <span class="keyword">for</span> j = 1:1:length(y)
        temp = R*[x(i,j);y(i,j)];
        rot_x(i,j) = temp(1);
        rot_y(i,j) = temp(2);
    <span class="keyword">end</span>
<span class="keyword">end</span>

figure;
surf(x,y,C);
hold <span class="string">on</span>
surf(rot_x,rot_y,C);
hold <span class="string">off</span>
view(-90,-90)
</pre><img vspace="5" hspace="5" src="lab3_36.png" alt=""> <p>Now do it for the image</p><pre class="codeinput">gogol_g = rgb2gray(gogol);
[x,y] = meshgrid(1:256);


[u,v] = meshgrid(1:256);
rot_u = zeros(256,256);
rot_v = zeros(256,256);
<span class="keyword">for</span> i = 1:1:length(u)
    <span class="keyword">for</span> j = 1:1:length(v)
        temp = R*[u(i,j);v(i,j)];
        rot_u(i,j) = temp(1);
        rot_v(i,j) = temp(2);
    <span class="keyword">end</span>
<span class="keyword">end</span>

rot_gogol = interp2(u,v, im2double(gogol_g), rot_u, rot_v, <span class="string">'cubic'</span>);
figure;
imshow(rot_gogol);
</pre><img vspace="5" hspace="5" src="lab3_37.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Lab 3
%%
clear all;
close all;
clc;
%% Spatial Frequencies 1
%%
% Loading in and Resizing the images
bricks = imread('bricks.jpg');
sky = imread('sky.jpg');

bricks_256 = imresize(bricks, [256 256]);
sky_256 = imresize(sky, [256 256]);
%%
% Displaying the Fourier Transform of the bricks and the sky
figure;
imshow(bricks_256)
bricks_gray = rgb2gray(bricks_256);
title('Sky Image')

figure;
imagesc(log(abs(fftshift(fft2(bricks_gray)))))
title('FFT of bricks')

figure;
imshow(sky_256)
sky_gray = rgb2gray(sky_256);
title('Sky image')

figure;
imagesc(log(abs(fftshift(fft2(sky_gray)))))
title('FFT of sky')
%%
% Applying a low pass filter to the bricks yields the following
lpf = fspecial('gaussian',5,1.7);
hpf = [0 0 0 0 0;
       0 0 0 0 0;
       0 0 1 0 0;
       0 0 0 0 0;
       0 0 0 0 0] - lpf;
bricks_lpf = imfilter(bricks_gray, lpf, 'replicate');
bricks_hpf = imfilter(bricks_gray, hpf, 'replicate');

figure;
imshow(uint8(bricks_lpf))
title('Bricks after LPF');
figure;
imagesc(log(abs(fftshift(fft2(bricks_lpf)))))
title('Magnitude of the bricks after LPF');
figure;
imagesc(angle(fftshift(fft2(bricks_lpf))))
title('Phase of the bricks after LPF');

figure;
imshow(uint8(bricks_hpf))
title('Bricks after HPF');
figure;
imagesc(log(abs(fftshift(fft2(bricks_hpf)))))
title('Magnitude of the bricks after HPF');
figure;
imagesc(angle(fftshift(fft2(bricks_hpf))))
title('Phase of the bricks after HPF');
%% 
% The energy for the high pass and low pass are given by:
energy_lpf = norm(fft2(bricks_lpf),2);
energy_hpf = norm(fft2(bricks_hpf),2);
fprintf('Bricks Energy HPF = %d, LPF Energy = %d\n', energy_hpf, energy_lpf);
%% 
% Doing the same to the sky image yields the following:
sky_lpf = imfilter(sky_gray, lpf, 'replicate');
sky_hpf = imfilter(sky_gray, hpf, 'replicate');

figure;
imshow(uint8(sky_lpf))
title('Sky after LPF');
figure;
imagesc(log(abs(fftshift(fft2(sky_lpf)))))
title('Magnitude of the sky after LPF');
figure;
imagesc(angle(fftshift(fft2(sky_lpf))))
title('Phase of the sky after LPF');

figure;
imshow(uint8(sky_hpf))
title('Sky after HPF');
figure;
imagesc(log(abs(fftshift(fft2(sky_hpf)))))
title('Magnitude of the sky after HPF');
figure;
imagesc(angle(fftshift(fft2(sky_hpf))))
title('Phase of the sky after HPF');

%% 
% The energy for the high pass and low pass are given by:
energy_lpf = norm(fft2(sky_lpf),2);
energy_hpf = norm(fft2(sky_hpf),2);
fprintf('Sky Energy HPF = %d, LPF Energy = %d\n', energy_hpf, energy_lpf);
%%
% Adding in some singals to the FFT yields the following:
sky_fft = fftshift(fft2(sky_gray));

figure;
imagesc(log(abs(sky_fft)));
title('FFT before adding signal');

amt_to_add = 10e5;

sky_fft(128+64,128+64) = amt_to_add;
sky_fft(128-64,128-64) = amt_to_add;
sky_fft(128-64,128+64) = amt_to_add;
sky_fft(128+64,128-64) = amt_to_add;  

sky_fft(128,128+64) = amt_to_add;  
sky_fft(128,128-64) = amt_to_add;  
sky_fft(128+64,128) = amt_to_add;  
sky_fft(128-64,128) = amt_to_add;  

figure;
imagesc(log(abs(sky_fft)));
title('FFT after adding signal');

sky_fft_modified = ifftshift(sky_fft);
sky_gray_modfied = uint8(ifft2(sky_fft_modified));

figure;
imshow(sky_gray_modfied);
title('Image after adding signal');

%%
% Removing the signal
sky_fft(128+64,128+64) = 0;
sky_fft(128-64,128-64) = 0;
sky_fft(128-64,128+64) = 0;
sky_fft(128+64,128-64) = 0;  

sky_fft(128,128+64) = 0;  
sky_fft(128,128-64) = 0;  
sky_fft(128+64,128) = 0;  
sky_fft(128-64,128) = 0;  

figure;
imagesc(log(abs(sky_fft)));
title('FFT after removing signal');

sky_fft_modified = ifftshift(sky_fft);
sky_gray_modfied = uint8(ifft2(sky_fft_modified));

figure;
imshow(sky_gray_modfied);
title('Image after Removing signal');

%% Spatial Frequencies 2
% Load in the images
g_img = imread('G.jpg');
b_img = imread('B.jpg');

g_256 = imresize(g_img, [256 256]);
b_256 = imresize(b_img, [256 256]);

g_gray = rgb2gray(g_256);
g_gray = imrotate(g_gray, 90);
b_gray = rgb2gray(b_256);

g_fft = fft2(g_gray);
b_fft = fft2(b_gray);

figure;
imshow(g_gray);
title('G Image');

figure;
imagesc(log(abs(fftshift(g_fft))));
title('FFT of G Image');

figure;
imshow(b_gray);
title('B Image');

figure;
imagesc(log(abs(fftshift(b_fft))));
title('FFT of B Image');
%%
% Sharpening the image with unsharp
g_unsharp = imsharpen(g_gray);
b_unsharp = imsharpen(b_gray);

figure;
imshow(g_unsharp);
title('G with unsharp');

figure;
imshow(b_unsharp);
title('B with unsharp');

%%
% Sharpening the images with high boost
[J0, J1] = Highboost(g_gray, 1.5);

figure;
imshow(J0);
title('G with highboost - J0');

figure;
imshow(J1);
title('G with highboost - J1');

[J0, J1] = Highboost(b_gray, 1.5);

figure;
imshow(J0);
title('B with highboost - J0');

figure;
imshow(J1);
title('B with highboost - J1');

%%
% Swapping the phase of the two images.
g_mag = abs(g_fft);
b_mag = abs(b_fft);
g_phase = angle(g_fft);
b_phase = angle(b_fft);

swapped1 = g_mag .* exp(1i*b_phase);
swapped2 = b_mag .* exp(1i*g_phase);

s1_img = uint8(ifft2(swapped1));
s2_img = uint8(ifft2(swapped2));

figure;
imshow(s1_img);
title('G Magnitude with B phase');

figure;
imshow(s2_img);
title('B Magnitude with G phase');
%% More Fun with Frequencies

gogol = imread('fg2.jpg');
%gogol = imcrop(gogol, [194 290 333 538]);
gogol = imcrop(gogol, [194 290 139 248]);
gogol = imresize(gogol, [256 256]);

jesse = imread('Jesse.jpg');
%jesse = imcrop(jesse, [163 177 260 351]);
jesse = imcrop(jesse, [163 177 97 174]);
jesse = imresize(jesse, [256 256]);

fixedPt = [82 118; 172 120];
movingPt = [90 128; 176 139];

tform = fitgeotrans(movingPt,fixedPt,'NonreflectiveSimilarity');

Jregistered = imwarp(jesse,tform,'OutputView',imref2d(size(gogol)));

figure;
imshowpair(gogol,Jregistered)
title('Images of Jesse and Me after being reg');

lpf = fspecial('gaussian',5,10);
hpf = [0 0 0 0 0;
       0 0 0 0 0;
       0 0 1 0 0;
       0 0 0 0 0;
       0 0 0 0 0] - lpf;

gogol_lpf = imfilter(double(gogol), lpf, 'replicate');
Jregistered_hpf = imfilter(double(Jregistered), hpf, 'replicate');

figure;
imshow(uint8(gogol_lpf + 15*Jregistered_hpf));
title('High freq of Jesse and Low freq of Gogol');

%% Geometric Transforms
% Rotation a mesh
theta=-30;
theta=deg2rad(theta);
R = [cos(theta) -sin(theta);
    sin(theta) cos(theta)];


[x,y] = meshgrid(1:64);
C = 0.*(x + y);

rot_x = zeros(64,64);
rot_y = zeros(64,64);
for i = 1:1:length(x)
    for j = 1:1:length(y)
        temp = R*[x(i,j);y(i,j)];  
        rot_x(i,j) = temp(1);
        rot_y(i,j) = temp(2);
    end
end

figure;
surf(x,y,C);
hold on
surf(rot_x,rot_y,C);
hold off
view(-90,-90)


%%
% Now do it for the image
gogol_g = rgb2gray(gogol);
[x,y] = meshgrid(1:256);


[u,v] = meshgrid(1:256);
rot_u = zeros(256,256);
rot_v = zeros(256,256);
for i = 1:1:length(u)
    for j = 1:1:length(v)
        temp = R*[u(i,j);v(i,j)];  
        rot_u(i,j) = temp(1);
        rot_v(i,j) = temp(2);
    end
end

rot_gogol = interp2(u,v, im2double(gogol_g), rot_u, rot_v, 'cubic');
figure;
imshow(rot_gogol);


##### SOURCE END #####
--></body></html>